import pandas as pd
from python_wordpress_api import create_post as wp
from python_wordpress_api import template_preparation as tp


# size setup for pandas
pd.set_option('display.max_rows', 500)
pd.set_option('display.max_columns', 500)
pd.set_option('display.width', 1000)


def insert_data(file):

    # open the open data file
    data_file = pd.read_csv('Output_files/' + file + '_copy.csv')

    # open the theme to be inserted into a post
    template = open('Template/' + file + '_template.txt')

    # check the type of the post

    if file == 'Library':
        # call library prepare
        return tp.library_prepare(data_file, template)

    elif file == 'Sports':
        return tp.sport_prepare(data_file, template)





def main():
    # load place processed open data files in CSV format
    files = ['Sports'] # ['Library', 'Sports']

    # loop throw files and open consponder template
    for file in files:
        final_template = insert_data(file)
        client = wp.connect_to_wordpress_api()
        wp.create_new_post(client,final_template)





if __name__ == "__main__":
    main()
